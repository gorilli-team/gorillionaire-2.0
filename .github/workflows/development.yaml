on:
  push:
    branches:
      - '**'
permissions:
  id-token: write
  contents: read

jobs:
  configure-aws:
    uses: ./.github/workflows/aws_credentials.yaml
    with:
      environment: development
      AWS_ACCOUNT_ID: ${{ secrets.AWS_ACCOUNT_ID }}
      AWS_DEPLOY_ROLE: ${{ secrets.AWS_DEPLOY_ROLE }}

  deploy-infra:
    needs: configure-aws
    uses: ./.github/workflows/aws_deploy_infra.yaml
    with:
      environment: development
